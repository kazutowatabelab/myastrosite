---
// 1行目にこれが必要です！
import BlogPost from './BlogPost.astro';

const { content, lang = 'en', ...props } = Astro.props;

const isEn = lang === 'en';

// 前回の currentSlug 定義も忘れずに
const currentSlug = content?.id || props.id || ''; 

const title = isEn 
  ? (content?.title_en || content?.title || props.title || "Untitled") 
  : (content?.title || props.title || "無題");

const pubDate = content?.publishedAt || props.pubDate;
const heroImage = content?.eyecatch?.url || props.heroImage;

const jpPath = `/blog/jp/${currentSlug}`;
const enPath = `/blog/en/${currentSlug}`;
---

<BlogPost title={title} pubDate={pubDate} heroImage={heroImage} {...props}>
  <div class="lang-switch">
    <a href={jpPath} class={lang === 'jp' ? 'active' : ''}>日本語</a>
    <span>/</span>
    <a href={enPath} class={lang === 'en' ? 'active' : ''}>English</a>
  </div>
  
  <slot />
</BlogPost>

<style>
  .lang-switch {
    text-align: right;
    margin-bottom: 2rem;
    font-size: 0.9rem;
  }
  .lang-switch a {
    text-decoration: none;
    color: #888;
  }
  .lang-switch a.active {
    font-weight: bold;
    color: #000;
    text-decoration: underline;
  }

  :global(.hero-image) {
    width: 100% !important;
    max-width: none !important;
    display: flex !important;
    justify-content: flex-start !important;
    margin: 0 0 2rem 0 !important;
  }

  :global(.hero-image img) {
    max-width: 600px !important;
    width: 100% !important;
    height: auto !important;
    margin-left: 0 !important;
    margin-right: auto !important;
    border-radius: 8px;
    object-fit: contain !important;
  }
</style>